# SYNOPSIS:
#
#   make [all]  - makes everything.
#   make TARGET - makes the given target.
#   make clean  - removes all files generated by make.

GTEST_DIR = ../google-test
include $(GTEST_DIR)/TestSettings

TESTS = is_prime_unittest

# House-keeping build targets.
all : build test

build : $(TESTS)

test : $(TESTS:unittest=unittest-run)

clean :
	rm -f $(TESTS) *.o

# Builds a sample test. A test should link with either $(GTEST) or
# $(GTEST_MAIN), depending on whether it defines its own main()
# function.

is_prime.o : is_prime.cpp is_prime.h
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c is_prime.cpp

is_prime_unittest.o : is_prime_unittest.cpp is_prime.h 
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -c is_prime_unittest.cpp

is_prime_unittest : is_prime.o is_prime_unittest.o $(GTEST_MAIN)
	$(CXX) $(CPPFLAGS) $(CXXFLAGS) -lpthread $^ -o $@

is_prime_unittest-run : is_prime_unittest
	./is_prime_unittest